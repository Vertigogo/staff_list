from collections import defaultdict
from functools import partial
import logging
from typing import (
  